# cluster

http2를 적용하면서 cluster도 사용하면 좋다.

왜냐, 서버는 기본적으로 싱글쓰레드이기 때문에 하나의 코어만 사용한다.
만약, 코어가 8개가 있는 컴퓨터라면 1개의 코어만 사용되고 7개는 놀고 있으므로 비효율적이다. 코어를 효율적으로 사용하기 위해 cluster를 사용한다.

node의 워커쓰레드와 비슷하다. 워커쓰레드는 멀티쓰레딩을 할 수 있는 것이고, cluster는 멀티 프로세싱을 할 수 있는 것이다.

원래는 서버 하나에 포트번호 하나만 사용할 수 있지만, cluster를 사용하면 하나의 포트에 여러개의 서버를 묶을 수 있다.

이런 cluster에도 단점이 있다. 프로세스를 여러개 띄우기 때문에 메모리, 세션을 공유하지 못한다. 특히, 로그인을 구현할 때 매우 힘들다. 어떤 서버에서는 로그인이 되어있고, 어떤 서버에서는 로그인이 되어있지 않는 상황이 생기기 때문이다. 이런 문제를 해결하기 위해서 redis를 사용한다.

싱글쓰레드보다 효율적이긴 하지만, 하나의 코어를 사용하다가 6개의 코어를 사용한다해도 코어 갯수배 만큼(6배) 성능이 개선되지는 않는다.
